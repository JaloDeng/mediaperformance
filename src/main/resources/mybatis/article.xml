<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.foshanplus.mediaperformance.mapper.ArticleMapper" >

	<!-- Result Map-->
	<resultMap id="BaseResultMap" type="com.foshanplus.mediaperformance.bean.Article" >
		<result column="id" property="id"/>
		<result column="paper_publish_time" property="paperPublishTime"/>
		<result column="page" property="page"/>
		<result column="category" property="category"/>
		<result column="paper_title" property="paperTitle"/>
		<result column="author" property="author"/>
		<result column="article_type" property="articleType"/>
		<result column="editor" property="editor"/>
		<result column="app_title" property="appTitle"/>
		<result column="app_publish_time" property="appPublishTime"/>
		<result column="word_count" property="wordCount"/>
		<result column="click_count" property="clickCount"/>
		<result column="url" property="url"/>
		<result column="level" property="level"/>
		<result column="score" property="score"/>
		<result column="create_user" property="createUser"/>
		<result column="create_time" property="createTime"/>
		<result column="update_user" property="updateUser"/>
		<result column="update_time" property="updateTime"/>
	</resultMap>
	
	<!-- sys_user table all fields -->
	<sql id="App_List" >
		id, category, author, article_type, editor, app_title, app_publish_time, 
		word_count, click_count, url, level, score, create_user, create_time, update_user, update_time
	</sql>
	<sql id="Paper_List" >
		id, paper_publish_time, page, category, paper_title, author, article_type, editor,
		word_count, level, score, create_user, create_time, update_user, update_time
	</sql>
	<sql id="App_Paper_List" >
		id, paper_publish_time, page, category, paper_title, author, article_type, editor, app_title, app_publish_time, 
		word_count, click_count, url, level, score, create_user, create_time, update_user, update_time
	</sql>
	
	<select id="queryAppById" resultMap="BaseResultMap">
		select a.* from t_app a where a.id = #{id}
	</select>
	
	<select id="findApp" parameterType="Object" resultMap="BaseResultMap">
		SELECT <include refid="App_List" />
		FROM t_app
		<where>
		<if test="publishTimeStart != null and publishTimeStart != '' and publishTimeEnd != null and publishTimeEnd != ''">
			AND publishTime between #{publishTimeStart} AND #{publishTimeEnd}
		</if>
		<if test="category != null and category != ''">
			AND category = #{category}
		</if>
		<if test="appTitle != null and appTitle != ''">
			AND app_title like CONCAT('%', '${appTitle}', '%')
		</if>
		<if test="author != null and author != ''">
			AND author like CONCAT('%', '${author}', '%')
		</if>
		<if test="articleType != null and articleType != ''">
			AND article_type = #{articleType}
		</if>
		<if test="editor != null and editor != ''">
			AND editor like CONCAT('%', '${editor}', '%')
		</if>
		<if test="level != null and level != ''">
			AND level = #{level}
		</if>
		<if test="isScore != null and isScore != '' ">
		<choose>
			<when test="isScore = '1'">
				AND score != ''
			</when>
			<otherwise>
				AND score = ''
			</otherwise>
		</choose>
		</if>
		</where>
	</select>
	
	<insert id="addApp" parameterType="com.foshanplus.mediaperformance.bean.Article">
		INSERT INTO t_app(app_publish_time, category, app_title, author, article_type, editor, word_count, click_count
			, url, level, score, create_user, create_time, update_user, update_time)
		values(#{appPublishTime}, #{category}, #{appTitle}, #{author}, #{articleType}, #{editor}, #{wordCount}, #{clickCount}
			, #{url}, #{level}, #{score}, #{createUser}, #{createTime}, #{updateUser}, #{updateTime}
		)
	</insert>
	
	<update id="updateApp" parameterType="com.foshanplus.mediaperformance.bean.Article">
		update t_app
		<set>
			<if test="appPublishTime != null">
				app_publish_time = #{appPublishTime,jdbcType=VARCHAR},
			</if>
			<if test="category != null">
				category = #{category,jdbcType=VARCHAR},
			</if>
			<if test="appTitle != null">
				app_title = #{appTitle,jdbcType=VARCHAR},
			</if>
			<if test="author != null">
				author = #{author,jdbcType=VARCHAR},
			</if>
			<if test="articleType != null">
				article_type = #{articleType,jdbcType=VARCHAR},
			</if>
			<if test="editor != null">
				editor = #{editor,jdbcType=VARCHAR},
			</if>
			<if test="wordCount != null">
				wordCount = #{wordCount,jdbcType=INT},
			</if>
			<if test="clickCount != null">
				clickCount = #{clickCount,jdbcType=INT},
			</if>
			<if test="url != null">
				url = #{url,jdbcType=VARCHAR},
			</if>
			<if test="level != null">
				level = #{level,jdbcType=VARCHAR},
			</if>
			<if test="score != null">
				score = #{score,jdbcType=INT},
			</if>
			<if test="updateUser != null">
				updateUser = #{updateUser,jdbcType=VARCHAR},
			</if>
			<if test="updateTime != null">
				updateTime = #{updateTime,jdbcType=VARCHAR},
			</if>
		</set>
		where id = #{id}
	</update>
	
	<delete id="deleteApp" parameterType="java.lang.Long">
		DELETE FROM t_app WHERE id = #{id}
	</delete>
	
</mapper>