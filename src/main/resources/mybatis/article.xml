<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.foshanplus.mediaperformance.mapper.ArticleMapper" >

	<!-- Result Map-->
	<resultMap id="BaseResultMap" type="com.foshanplus.mediaperformance.bean.Article" >
		<result column="id" property="id"/>
		<result column="type" property="type"/>
		<result column="paperPublishTime" property="paperPublishTime"/>
		<result column="appPublishTime" property="appPublishTime"/>
		<result column="page" property="page"/>
		<result column="category" property="category"/>
		<result column="articleType" property="articleType"/>
		<result column="paperTitle" property="paperTitle"/>
		<result column="appTitle" property="appTitle"/>
		<result column="author" property="author"/>
		<result column="editor" property="editor"/>
		<result column="wordCount" property="wordCount"/>
		<result column="clickCount" property="clickCount"/>
		<result column="url" property="url"/>
		<result column="level" property="level"/>
		<result column="score" property="score"/>
		<result column="createUser" property="createUser"/>
		<result column="createTime" property="createTime"/>
		<result column="updateUser" property="updateUser"/>
		<result column="updateTime" property="updateTime"/>
	</resultMap>
	
	<!-- sys_user table all fields -->
	<sql id="Article_List" >
		id, type, paperPublishTime, appPublishTime, page, category, articleType, paperTitle, appTitle, author, editor,
		wordCount, clickCount, url, level, score, createUser, createTime, updateUser, updateTime
	</sql>
	
	<insert id="add" parameterType="com.foshanplus.mediaperformance.bean.Article">
		INSERT INTO t_article(
			  type, newsSourceId, paperPublishTime, appPublishTime
			, page, category, articleType, paperTitle
			, appTitle, author, editor, wordCount
			, clickCount, url, level, score
			, createUser, createTime, updateUser, updateTime
		)
		values(
			  #{type}, #{newsSourceId}, #{paperPublishTime}, #{appPublishTime}
			, #{page}, #{category}, #{articleType}, #{paperTitle}
			, #{appTitle}, #{author}, #{editor}, #{wordCount}
			, #{clickCount}, #{url}, #{level}, #{score}
			, #{createUser}, #{createTime}, #{updateUser}, #{updateTime}
		)
	</insert>
	
	<delete id="delete" parameterType="java.lang.Long">
		DELETE FROM t_article WHERE id = #{id}
	</delete>
	
	<select id="findAll" resultMap="BaseResultMap">
		SELECT <include refid="Article_List" />
		FROM t_article
		<where>
		<if test="type != null">
			AND type = #{type}
		</if>
		<if test="paperStartTime != null and paperStartTime != '' and paperEndTime != null and paperEndTime != ''">
			AND paperPublishTime between #{paperStartTime} AND #{paperEndTime}
		</if>
		<if test="appStartTime != null and appStartTime != '' and appEndTime != null and appEndTime != ''">
			AND appPublishTime between #{appStartTime} AND #{appEndTime}
		</if>
		<if test="paperTitle != null and paperTitle != ''">
			AND paperTitle like CONCAT('%', '${paperTitle}', '%')
		</if>
		<if test="appTitle != null and appTitle != ''">
			AND appTitle like CONCAT('%', '${appTitle}', '%')
		</if>
		<if test="author != null and author != ''">
			AND author like CONCAT('%', '${author}', '%')
		</if>
		<if test="editor != null and editor != ''">
			AND editor like CONCAT('%', '${editor}', '%')
		</if>
		<if test="isScore != null and isScore != '' ">
		<choose>
			<when test="isScore = '1'">
				AND score != ''
			</when>
			<otherwise>
				AND score = ''
			</otherwise>
		</choose>
		</if>
		</where>
	</select>
	
	<select id="findById" resultMap="BaseResultMap">
		select <include refid="Article_List" /> from t_article a where a.id = #{id}
	</select>
	
	<update id="update" parameterType="com.foshanplus.mediaperformance.bean.Article">
		update t_article
		<set>
			<if test="type != null">
				type = #{type, jdbcType = TINYINT},
			</if>
			<if test="paperPublishTime != null">
				paperPublishTime = #{paperPublishTime, jdbcType = DATE},
			</if>
			<if test="appPublishTime != null">
				appPublishTime = #{appPublishTime, jdbcType = TIMESTAMP},
			</if>
			<if test="page != null">
				page = #{page, jdbcType = VARCHAR},
			</if>
			<if test="category != null">
				category = #{category, jdbcType = VARCHAR},
			</if>
			<if test="articleType != null">
				articleType = #{articleType, jdbcType = VARCHAR},
			</if>
			<if test="paperTitle != null">
				paperTitle = #{paperTitle, jdbcType = VARCHAR},
			</if>
			<if test="appTitle != null">
				appTitle = #{appTitle, jdbcType = VARCHAR},
			</if>
			<if test="author != null">
				author = #{author, jdbcType = VARCHAR},
			</if>
			<if test="editor != null">
				editor = #{editor, jdbcType = VARCHAR},
			</if>
			<if test="wordCount != null">
				wordCount = #{wordCount, jdbcType = INTEGER},
			</if>
			<if test="clickCount != null">
				clickCount = #{clickCount, jdbcType = INTEGER},
			</if>
			<if test="url != null">
				url = #{url, jdbcType = VARCHAR},
			</if>
			<if test="level != null">
				level = #{level, jdbcType = VARCHAR},
			</if>
			<if test="score != null">
				score = #{score, jdbcType = INTEGER},
			</if>
			<if test="updateUser != null">
				updateUser = #{updateUser, jdbcType = VARCHAR},
			</if>
			<if test="updateTime != null">
				updateTime = #{updateTime, jdbcType = TIMESTAMP},
			</if>
		</set>
		where id = #{id}
	</update>
	
</mapper>