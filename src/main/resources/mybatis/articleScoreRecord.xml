<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.foshanplus.mediaperformance.mapper.ArticleScoreRecordMapper" >

	<resultMap id="BaseResultMap" type="com.foshanplus.mediaperformance.bean.ArticleScoreRecord" >
		<result column="id" property="id"/>
		<result column="articleId" property="articleId"/>
		<result column="newsSourceId" property="newsSourceId"/>
		<result column="newsTransferId" property="newsTransferId"/>
		<result column="scoreId" property="scoreId"/>
		<result column="score" property="score"/>
		<result column="remark" property="remark"/>
		<result column="createUser" property="createUser"/>
		<result column="createTime" property="createTime"/>
		<result column="updateUser" property="updateUser"/>
		<result column="updateTime" property="updateTime"/>
	</resultMap>
	
	<sql id="Base_List" >
		id, articleId, newsSourceId, newsTransferId, scoreId, score, remark, createUser, createTime, updateUser, updateTime
	</sql>
	
	<insert id="add" parameterType="com.foshanplus.mediaperformance.bean.ArticleScoreRecord" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO t_article_score_record(articleId, newsSourceId, newsTransferId, scoreId, score, remark, createUser, updateUser)
		values(#{articleId}, #{newsSourceId}, #{newsTransferId}, #{scoreId}, #{score}, #{remark}, #{createUser}, #{updateUser})
	</insert>
	
	<update id="update" parameterType="com.foshanplus.mediaperformance.bean.ArticleScoreRecord">
		UPDATE t_article_score_record 
		SET 
			scoreId = #{scoreId}
			, score = #{score}
			, remark = #{remark}
			, updateUser = #{updateUser} 
		WHERE newsTransferId = #{newsTransferId}
	</update>
	
	<select id="countByNewsTransferId" resultType="java.lang.Integer">
		SELECT 
			COUNT(1) 
		FROM t_article_score_record asr 
		WHERE asr.newsTransferId = #{newsTransferId} 
			OR asr.articleId = #{articleId}
	</select>
	
</mapper>